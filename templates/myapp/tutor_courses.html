{% load i18n %}
{% load socialaccount %}

<!DOCTYPE html>
<html>
<head>
  {% load bootstrap5 %}
  {% bootstrap_css %}
  {% bootstrap_javascript %}

  <style>
    .logincontainer {
      background-image: url("https://wallpapercave.com/wp/wp5794418.jpg");
      margin-left: auto;
      margin-right: auto;
      margin-top: auto;
      width: auto;
      height: 100vh;
    }
    .logintext {
      position: absolute;
      text-align: center;
      padding-left: 70vh;
      padding-right: 70vh;
      padding-top: 15vh;
      padding-bottom: 50vh;
    }
  </style>

</head>
<body>
{% if user.is_authenticated %}
<div class="cover-container  mx-auto flex-column">
    <ul class="nav bg-info mx-auto">
      <a class="navbar-brand"href="/"><img src= "https://lh5.googleusercontent.com/PMyEMcnh7OuoAC_dPcDNxLGSoFZm8T1K9sob-VHKqBk74YqWJjugOfbulpRZGtn_TSY=w2400" alt="" width="35"  height="35"></a>
      <li class="nav-item">
        <a class="nav-link link-light" href="/tutor_courses">Find a Tutor</a>
      </li>
      <li class="nav-item">
        <a class="nav-link link-light" href="/submit_listing">Start Tutoring</a>
      </li>
      <li class="nav-item">
        <a class="nav-link link-light" href="/discussion">View Discussion</a>
      </li>
      <li class="nav-item">
        <a class="nav-link link-light" href="/profile">Profile</a>
      </li>
      <li class="nav-item">
        <a class="nav-link link-light" href="/logout">Log Out</a>
      </li>
      <li class="nav-item">
        <a class="nav-link disabled" >{{ user.username }}</a>
      </li>
    </ul>

<!-- Display every listing -->
<br/>




<body class="text-center">

    <main role="main" class="inner cover">
      <h3 class=" font-weight-normal">Browse Current UVA Tutor Listings</h3>
      <p class="lead"> Search for your tutor by course mnemonic or name.</p>

       
      <form class = "d-flex" method = POST action="{% url 'search-classes' %}">
        {%csrf_token%}
        <input class = "form-control form-control-lg" type = "search" placeholder = "Search..." name ="searched">
        <button class = "btn btn-primary" type = "Submit">Submit</button>
      </form>

      <br>
      <br>

      <ul class="list-group">
        {% for listing in listings %}
        
        <li class="list-group-item">
          <h5 class = "list-group-text" >{{  listing.first_name }} {{listing.last_name }} : {{ listing.headline }}  </h5>
          <p class = "list-group-item-text lead">{{ listing.qualifications }} </p>
          <button type="button" class="btn btn-info"> <span class="badge badge-dark"> {{ listing.course }}</span></button>
          <button type="button" class="btn btn-secondary"> <span class="badge badge-dark"> $ {{ listing.hourly_rate}}</span></button>
          <button type="button" class="btn btn-warning"> <span class="badge badge-dark"> {{ listing.avg_rating}} / 5</span></button>
          
                  <!-- Button trigger modal -->
        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
          Launch demo modal
        </button>

        <!-- Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-scrollable" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <ul class = "list-group">
                  {% for r in listing.tutorreviews.all%}
                    <li class="list-group-item  flex-column"> 
                      <div>  
                          {{listing.first_name}}
                          {{r.tutor}}
                          <strong> {{ r.rating }} : {{r.comment}} </strong>
                      </div>
                  {% endfor %}
                   </li>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-primary">Save changes</button>
              </div>
            </div>
          </div>
        </div>





        
          <br>
          <br>
        
           <!-- Button trigger modal -->
           <a href = "{% url 'update_listing' listing.pk %}">
            <button type="button" class="btn btn-outline-success">Book</button>
           </a>
        
          </li>
        
        {% endfor %}


        </ul>
  
    </main>
    

</body>


    

{% else %}
<div class="logincontainer">
  <div class="logintext">
    <h1 class="text-center">Welcome to Tutor Me! </h1>
    <p class="text-center">An UVA Undergraduate resource for matching Students with Tutors</p>
    <div class="row justify-content-evenly">
      <div class="col-4 text-start">
        <p>Not a member? <a href="accounts/signup" class="btn btn-success btn-lg">Sign Up</a> </p>
      </div>
      <div class="col-4 text-end">
        <p>Have an Account? <a href="accounts/login" class="btn btn-primary btn-lg">Sign In</a></p>
      </div>
   </div>
  </div>
</div>
{% endif %}

</div>
</body>


<footer class="bg-light text-center text-lg-start mt-auto">
  <div class="text-center p-3" style="background-color: rgba(173,216, 230, 0.2);">
    Â© 2023 Copyright: Team A-30
  </div>
</footer>


</html>
